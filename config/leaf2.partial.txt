system {
    configuration {
        auto-checkpoint true
        auto-save true
    }
}
network-instance default {
    protocols {
        bgp {
            autonomous-system 65002
            router-id 10.0.0.2
            afi-safi ipv4-unicast {
                admin-state enable
            }
            group ebgp-underlay {
                export-policy [
                    export-underlay
                ]
                import-policy [
                    import-underlay
                ]
            }
            group ibgp-overlay {
                peer-as 65000
                export-policy [
                    export-overlay
                ]
                import-policy [
                    import-overlay
                ]
                local-as {
                    as-number 65000
                }
                transport {
                    local-address 10.0.0.2
                }
            }
            neighbor 10.0.0.11 {
                peer-group ibgp-overlay
            }
            neighbor 10.0.0.12 {
                peer-group ibgp-overlay
            }
            neighbor 10.0.10.2 {
                peer-as 65100
                peer-group ebgp-underlay
            }
            neighbor 10.0.10.6 {
                peer-as 65100
                peer-group ebgp-underlay
            }
        }
    }
    interface system0.0 {
    }
    interface ethernet-1/1.0 {
    }
    interface ethernet-1/31.0 {
    }
    interface ethernet-1/32.0 {
    }
}
interface system0 {
    admin-state enable
    subinterface 0 {
        admin-state enable
        ipv4 {
            admin-state enable
            address 10.0.0.2/32 {
            }
        }
    }
}
interface ethernet-1/1 {
    admin-state enable
    subinterface 0 {
        admin-state enable
        ipv4 {
            admin-state enable
            address 192.168.2.1/24 {
            }
        }
    }
}
interface ethernet-1/31 {
    admin-state enable
    subinterface 0 {
        admin-state enable
        ipv4 {
            admin-state enable
            address 10.0.10.3/31 {
            }
        }
    }
}
interface ethernet-1/32 {
    admin-state enable
    subinterface 0 {
        admin-state enable
        ipv4 {
            admin-state enable
            address 10.0.10.7/31 {
            }
        }
    }
}
routing-policy {
    prefix-set clients {
        prefix 192.168.0.0/22 mask-length-range 24..24 {
        }
    }
    prefix-set loopbacks {
        prefix 10.0.0.0/24 mask-length-range 32..32 {
        }
    }
    policy export-overlay {
        statement accept-clients {
            match {
                prefix {
                    prefix-set clients
                }
            }
            action {
                policy-result accept
            }
        }
    }
    policy export-underlay {
        statement accept-loopbacks {
            match {
                prefix {
                    prefix-set loopbacks
                }
            }
            action {
                policy-result accept
            }
        }
    }
    policy import-overlay {
        statement accept-clients {
            match {
                prefix {
                    prefix-set clients
                }
            }
            action {
                policy-result accept
            }
        }
    }
    policy import-underlay {
        statement accept-loopbacks {
            match {
                prefix {
                    prefix-set loopbacks
                }
            }
            action {
                policy-result accept
            }
        }
    }
}

